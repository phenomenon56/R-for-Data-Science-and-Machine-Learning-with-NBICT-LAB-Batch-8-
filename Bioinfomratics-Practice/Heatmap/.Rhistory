meta$Strain_Name
rownames(meta.water)= meta$Strain_Name
colnames(meta.water) = 'Water'
gheatmap(t1, meta.water)
t1= ggtree(tree, layout = 'circular') %<+% meta +
geom_tippoint(aes(color = Host))+
geom_tiplab(aes(x= x+0.005))
t1
t1= ggtree(tree, layout = 'circular') %<+% meta +
geom_tippoint(aes(color = Host))+
geom_tiplab(aes(x= x+0.001))
t1
t1= ggtree(tree, layout = 'circular') %<+% meta +
geom_tippoint(aes(color = Host))+
geom_tiplab(aes(x= x+0.008))
t1
t1= ggtree(tree, layout = 'circular') %<+% meta +
geom_tippoint(aes(color = Host))+
geom_tiplab(aes(x= x+0.1))
t1
runif(10)
# Generating  10000 numbers of uniform distribution
r=runif(10000)
hist(r)
meanr=mean(r)
sdr=sd(r)
# Draw three random samples from the distribution
samples1=sample(r,4)
samples1
samples2=sample(r,4)
samples2
samples3=sample(r,4)
samples3
mean(samples1)
mean(samples2)
mean(samples3)
cl4
# Run a For loop in R
cl4=mean(sample(r,4))
cl4
for (i in 1:1000) {
cl4=c(cl4=mean(sample(r,4)))
}
cl4
hist(cl4)
for (i in 1:1000){
cl4=c(cl4=mean(sample(r,4)))
}
cl4
for (i in 1:1000){
cl100 <- c(cl100, mean(sample(r,100)))
}
cl100
cl100=mean(sample(r,100))
cl100
for (i in 1:1000){
cl100 <- c(cl100, mean(sample(r,100)))
}
hist(cl100)
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Bioinfomratics-Practice/Heatmap")
library(pheatmap)
library(RColorBrewer)
library(ggplot2)
library(tidyr)
library(dplyr)
df <- read.csv("heatmap.csv", header = TRUE, stringsAsFactors = FALSE, check.names = FALSE)
rownames(df) <- df[[1]]
df <- df[, -1, drop = FALSE]
mat <- as.matrix(df)
mat <- apply(mat, 2, function(x) as.numeric(as.character(x)))
rownames(mat) <- rownames(df)
cat_mat[mat >= 1 & mat <= 10]  <- 1L
cat_mat <- matrix(NA_integer_, nrow = nrow(mat), ncol = ncol(mat),
dimnames = list(rownames(mat), colnames(mat)))
cat_mat[mat >= 1 & mat <= 10]  <- 1L
cat_mat[mat >= 11 & mat <= 15] <- 2L
cat_mat[mat >= 16]             <- 3L
my_colors <- c("red", "yellow", "green")
pheatmap::pheatmap(cat_mat,
color = my_colors,
breaks = c(0.5, 1.5, 2.5, 3.5),     # ensure discrete mapping
legend_breaks = c(1,2,3),
legend_labels = c("1-10", "11-15", ">=16"),
main = "Antibiotic resistant pattern of isolated pathogens",
cluster_rows = FALSE,
cluster_cols = FALSE,
display_numbers = mat,              # overlay original numeric zones
number_color = "black",
fontsize_number = 10,
na_col = "grey90",
border_color = "white")
head(df)
str(df)
head(mat)
head(cat_mat)
mat <- as.matrix(sapply(df, as.numeric))
rownames(mat) <- rownames(df)
pheatmap::pheatmap(cat_mat,
color = my_colors,
breaks = c(0.5, 1.5, 2.5, 3.5),
legend_breaks = c(1,2,3),
legend_labels = c("1-10", "11-15", ">=16"),
main = "Antibiotic resistant pattern of isolated pathogens",
cluster_rows = FALSE,
cluster_cols = FALSE,
display_numbers = mat,
number_color = "black",
fontsize_number = 10,
na_col = "grey90",
border_color = "white")
head(mat)
head(cat_mat)
colnames(df) <- gsub("\\\\n", " ", colnames(df))   # replace "\n" with space
colnames(df) <- gsub("\n", " ", colnames(df))     # real newlines
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Bioinfomratics-Practice/Heatmap")
library(pheatmap)
library(RColorBrewer)
library(ggplot2)
library(tidyr)
library(dplyr)
df <- read.csv("heatmap.csv", header = TRUE, stringsAsFactors = FALSE, check.names = FALSE)
df <- read.csv("heatmap.csv", header = TRUE, stringsAsFactors = FALSE, check.names = FALSE)
View(df)
pheatmap(df,
cluster_rows = T, cluster_cols = T, # set to FALSE if you want to remove the dendograms
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D')
str(df)
df_numeric <- df[, -1]
df_mat <- as.matrix(df_numeric)
rownames(df_mat) <- df$Strain
pheatmap(df_mat,
cluster_rows = TRUE, cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D')
print(
pheatmap(df_mat,
cluster_rows = TRUE, cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D')
)
gc()
colnames(df_mat) <- gsub("�", "ug", colnames(df_mat))   # replace � with 'ug'
colnames(df_mat) <- iconv(colnames(df_mat), from = "", to = "UTF-8", sub = "u")
pheatmap(df_mat,
cluster_rows = TRUE, cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D')
pheatmap(df_mat,
cluster_rows = TRUE, cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 45,
fontsize_row = 8,
fontsize_col = 8,
treeheight_row = 30,   # control dendrogram space
treeheight_col = 30)
pheatmap(df_mat,
cluster_rows = TRUE, cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 90,
fontsize_row = 8,
fontsize_col = 8,
treeheight_row = 30,   # control dendrogram space
treeheight_col = 30)
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 90,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 10,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 45,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 90,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 180,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 270,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 315,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
display_numbers = TRUE,
number_color = "black",
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
legend = FALSE,
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
angle_col = 0,
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 8,
fontsize_col = 8,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 5,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 8,
fontsize_col = 5,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 5,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 6,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
main = "Antibiotic resistance profiling of isolated pathogens")
pathogen_info <- read.csv("Pathogen_info.csv", stringsAsFactors = FALSE)
pathogen_annotation <- pathogen_info
rownames(pathogen_annotation) <- pathogen_annotation$Strain
pathogen_annotation <- pathogen_annotation[, -1, drop = FALSE]
pathogen_colors <- list(
Pathogen = c("Salmonella spp." = "#1f77b4",
"E.coli" = "#ff7f0e",
"Pseudomonas spp." = "#2ca02c",
"Klebsiella spp." = "#d62728")
)
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
annotation_row = pathogen_annotation,
annotation_colors = pathogen_colors,
main = "Antibiotic resistance profiling of isolated pathogens")
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
annotation_row = pathogen_annotation,
annotation_colors = pathogen_colors,
main = "Antibiotic resistance profiling of isolated pathogens",
cellwidth = 15,
cellheight = 10)
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
annotation_row = pathogen_annotation,
annotation_colors = pathogen_colors,
main = "Antibiotic resistance profiling of isolated pathogens",
cellwidth = 25,
cellheight = 10)
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
annotation_row = pathogen_annotation,
annotation_colors = pathogen_colors,
main = "Antibiotic resistance profiling of isolated pathogens",
cellwidth = 20,
cellheight = 10)
pathogen_colors <- list(
Pathogen = c("Salmonella spp." = "#1f77b4",
"E.coli" = "#ff7f0e",
"Pseudomonas spp." = "#2ca02c",
"Klebsiella spp." = "#5E2A72")
)
pheatmap(df_mat,
cluster_rows = TRUE,
cluster_cols = TRUE,
clustering_distance_cols = 'euclidean',
clustering_distance_rows = 'euclidean',
clustering_method = 'ward.D',
fontsize_row = 7,
fontsize_col = 7,
treeheight_col = 30,  # control column dendrogram height
treeheight_row = 30,  # control row dendrogram height
col = brewer.pal(10, 'RdYlGn'),
annotation_row = pathogen_annotation,
annotation_colors = pathogen_colors,
main = "Antibiotic resistance profiling of isolated pathogens",
cellwidth = 20,
cellheight = 10)
