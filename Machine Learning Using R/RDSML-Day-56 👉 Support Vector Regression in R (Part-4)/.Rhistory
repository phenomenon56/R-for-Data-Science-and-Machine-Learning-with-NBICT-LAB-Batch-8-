library(e1071)
library(dplyr)
library(ggplot2)
dataset <- read.csv("day.csv")
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Machine Learning Using R/RDSML-Day-55 ðŸ‘‰ Support Vector Regression in R (Part-3)")
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
str(bike)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(workingday),
weathersit = factor(weathersit)
)
str(bike)
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols <- c("temp", "atemp", "hum", "windspeed")
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
scale_num <- function(df){
df[, num_cols]<- sweep(df[, num_cols], 2,train_means, "-")
df[, num_cols]<- sweep(df[, num_cols], 2,train_sds, "/")
df                                                          ## 1- row-wise, 2-column-wise
}
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
library(dbplyr)
library(e1071)
library(ggplot2)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Machine Learning Using R/RDSML-Day-55 ðŸ‘‰ Support Vector Regression in R (Part-3)")
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday, weekday, workingday, weathersit)
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Machine Learning Using R/RDSML-Day-55 ðŸ‘‰ Support Vector Regression in R (Part-3)")
library(dplyr)
library(e1071)
library(ggplot2)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
str(bike)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(workingday),
weathersit = factor(weathersit)
)
str(bike)
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols <- c("temp", "atemp", "hum", "windspeed")
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
scale_num <- function(df){
df[, num_cols]<- sweep(df[, num_cols], 2,train_means, "-")
df[, num_cols]<- sweep(df[, num_cols], 2,train_sds, "/")
df                                                          ## 1- row-wise, 2-column-wise
}
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
lm_model <- lm(cnt ~., data = train_scaled)
summary(lm_model)
lm_pred <- predict(lm_model, newdata = test_scaled)
lm_pred
rmse <- function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse <- rmse(test_scaled$cnt, lm_pred)
lm_rmse
mae <- function(actual, pred) mean(abs(actual-pred))
mae
lm_mae <- mae(test_scaled$cnt, lm_pred)
lm_mae
svr <- svm(cnt~.,data = train_scaled, kernel = "linear")
svr_pred <- predict(svr, newdata = test_scaled)
svr_pred
svr_rmse <- rmse(test_scaled$cnt, svr_pred)
svr_rmse
svr_mae <- mae(test_scaled$cnt, svr_pred)
svr_mae
setwd("C:/Users/Irfan/OneDrive/Practice_R/R-for-Data-Science-and-Machine-Learning-with-NBICT-LAB-Batch-8-/Machine Learning Using R/RDSML-Day-56 ðŸ‘‰ Support Vector Regression in R (Part-4)")
library(dplyr)
library(e1071)
library(ggplot2)
dataset <- read.csv("day.csv")
bike <- dataset %>%
select(cnt, temp, atemp, hum, windspeed, season, yr, mnth,
holiday,weekday,workingday,weathersit)
str(bike)
bike <- bike %>%
mutate(
season = factor(season),
yr = factor(yr),
mnth = factor(mnth),
holiday = factor(holiday),
weekday = factor(weekday),
workingday = factor(workingday),
weathersit = factor(weathersit)
)
str(bike)
set.seed(123)
n <- nrow(bike)
indices <- seq_len(n)
train_idx <- sample(indices, size = 0.7*n)
train_set <- bike[train_idx, ]
test_set <- bike[-train_idx, ]
num_cols <- c("temp", "atemp", "hum", "windspeed")
train_means <- sapply(train_set[, num_cols], mean)
train_sds <- sapply(train_set[, num_cols], sd)
scale_num <- function(df){
df[, num_cols]<- sweep(df[, num_cols], 2,train_means, "-")
df[, num_cols]<- sweep(df[, num_cols], 2,train_sds, "/")
df
}
train_scaled <- scale_num(train_set)
test_scaled <- scale_num(test_set)
lm_model <- lm(cnt ~., data = train_scaled)
summary(lm_model)
lm_pred <- predict(lm_model, newdata = test_scaled)
rmse <- function(actual, pred) sqrt(mean((actual-pred)^2))
lm_rmse <- rmse(test_scaled$cnt, lm_pred)
mae <- function(actual, pred) mean(abs(actual-pred))
lm_mae <- mae(test_scaled$cnt, lm_pred)
svr <- svm(cnt~.,data = train_scaled, kernel = "linear")
svr_pred <- predict(svr, newdata = test_scaled)
svr_rmse <- rmse(test_scaled$cnt, svr_pred)
svr_mae <- mae(test_scaled$cnt, svr_pred)
svr_rmse; svr_mae
svr_rbf <- svm(
cnt ~.,
data = train_scaled,
kernel = "radial",
cost = 10,
gamma = 0.1,
epsilon = 0.1
)
svr_rbf_pred <- predict(svr_rbf, newdata = test_scaled)
svr_rbf_rmse <- rmse(test_scaled$cnt, svr_rbf_pred)
svr_rbf_mae <- mae(test_scaled$cnt, svr_rbf_pred)
svr_rbf_rmse; svr_rbf_mae
lm_rmse; lm_mae
