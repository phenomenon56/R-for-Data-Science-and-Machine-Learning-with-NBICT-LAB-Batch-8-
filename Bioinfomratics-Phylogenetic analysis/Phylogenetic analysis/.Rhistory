# Add tip labels (Country), push them out with offset
t2 <- t2 + geom_tiplab2(aes(label = Country), color = "gray40", size = 2.5, offset = 0.25)
# Final touches
t2 + theme(
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
plot.margin = margin(5, 5, 5, 5),
legend.position = "right"
)
sal.tree <- read.iqtree('test_salmonella_with_ERRiiiiiiiiiiiii_outgroup3.nex.treefile')
sal.tree@phylo <- midpoint(sal.tree@phylo)
sal.meta <- read.csv('metadata.csv', header = TRUE)
t1 <- ggtree(sal.tree, layout = "circular", size = 0.9, open.angle = 0) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2) +
theme(legend.position = "right")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot >= 70), "bootstrap"] <- '1'
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot >= 70), "bootstrap"] <- '1'
t1 <- ggtree(sal.tree, layout = "circular", size = 0.9, open.angle = 0) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2) +
theme(legend.position = "right")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot >= 70), "bootstrap"] <- '1'
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot >= 70), "bootstrap"] <- '1'
t1 <- ggtree(sal.tree, layout = "circular", size = 0.9, open.angle = 0) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2) +
theme(legend.position = "right")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot >= 70), "bootstrap"] <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color = bootstrap == '1'), size = 0.9) +
scale_color_manual(name = "Bootstrap", values = c("TRUE" = "black", "FALSE" = "gray80"), guide = "none")
t1
# Prepare metadata
meta.Susceptibility <- data.frame(Susceptibility = sal.meta$Susceptiblity)
rownames(meta.Susceptibility) <- sal.meta$Strain
meta.year <- data.frame(Year = sal.meta$Year)
rownames(meta.year) <- sal.meta$Strain
# Add heatmap layers (adjust offsets and widths)
t2 <- gheatmap(t1, meta.Susceptibility, width = 0.03, offset = 0.02, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
t2 <- gheatmap(t2, meta.year, width = 0.03, offset = 0.06, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
# Add country labels farther out
t2 <- t2 + geom_tiplab2(aes(label = Country), color = "gray30", size = 3.2, offset = 0.12)
# Final theme tweaks
t2 <- t2 + theme(
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
plot.margin = margin(10, 10, 10, 10),
legend.position = "right"
)
# View final result
print(t2)
install.packages(ggtreeExtra)
install.packages("ggtreeExtra")
library(ggthemes)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtreeExtra")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtreeExtra", ask = F)
# Generate 40 fake Salmonella strain names
species <- c("S.enterica", "S.bongori", "S.typhi", "S.typhimurium", "S.paratyphi",
"S.choleraesuis", "S.arizonae", "S.agona", "S.newport", "S.heidelberg")
strains <- paste0(sample(species, 40, replace = TRUE), "_Strain", 1:40)
# Build random pairs recursively to simulate a tree
make_tree <- function(tips) {
while (length(tips) > 1) {
i <- sample(1:(length(tips) - 1), 1)
new_node <- paste0("(", tips[i], ":0.1,", tips[i+1], ":0.1):0.2")
tips <- tips[-c(i, i+1)]
tips <- append(tips, new_node)
}
return(paste0(tips, ";"))
}
tree_string <- make_tree(strains)
# Save Newick tree
writeLines(tree_string, "salmonella_40_tree.nwk")
# # Simulate metadata
set.seed(123)
metadata <- data.frame(
Strain = gsub(" ", "_", strains),
Country = sample(c("USA", "India", "Bangladesh", "UK", "Nepal", "China", "Pakistan"), 40, replace = TRUE),
Source = sample(c("human", "animal", "environment"), 40, replace = TRUE),
Susceptiblity = sample(c("MDR", "PDR", "NR"), 40, replace = TRUE),
Year = sample(1990:2022, 40, replace = TRUE)
)
write.csv(metadata, "salmonella_40_metadata.csv", row.names = FALSE)
tree <- read.tree("salmonella_40_tree.nwk")
meta <- read.csv("salmonella_40_metadata.csv")
tree <- midpoint(tree)
p <- ggtree(tree,size = 0.8) %<+% meta +
geom_tippoint(aes(color = Source), size = 2.5) +
theme(legend.position = "right")
p
p <- ggtree(tree, layout = "circular", size = 0.8) %<+% meta +
geom_tippoint(aes(color = Source), size = 2.5) +
theme(legend.position = "right")
p
p <- ggtree(tree, layout = "circular", size = 0.8) %<+% meta +
geom_tippoint(aes(color = Source), size = 2.5) +
theme(legend.position = "right")
p
p$data$SH_aLRT <- sample(50:100, nrow(p$data), replace = TRUE)
p$data$UFboot <- sample(50:100, nrow(p$data), replace = TRUE)
p$data$bootstrap <- ifelse(p$data$SH_aLRT >= 70 & p$data$UFboot >= 70, "1", "0")
p <- p + new_scale_color() +
geom_tree(aes(color = bootstrap == "1"), size = 0.9) +
scale_color_manual(name = "Bootstrap", values = c("TRUE" = "black", "FALSE" = "gray70"), guide = "none")
p
meta.sus <- data.frame(Susceptibility = meta$Susceptiblity)
rownames(meta.sus) <- meta$Strain
p1 <- gheatmap(p, meta.sus, offset = 0.02, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 0.05, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.06, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 0.09, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.13, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 0.21, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.27, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 0.40, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.47, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 0.70, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.47, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 1.1, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.77, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 1.3, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 0.87, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 1.5, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.1, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.3, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.4, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.3, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.12, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.14, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.17, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.03, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.24, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.12, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.09, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.24, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.14, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.24, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.17, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.24, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.17, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.34, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.17, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.37, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.28, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.21, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.37, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.28, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.21, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.41, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.28, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.21, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.44, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.28, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.21, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.47, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.28, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.21, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.51, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.6, width = 0.32, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.51, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.9, width = 0.32, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.54, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.9, width = 0.32, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.57, size = 2.5, color = "gray40")
final_plot
p1 <- gheatmap(p, meta.sus, offset = 1.9, width = 0.32, colnames = FALSE) +
scale_fill_viridis_d(option = "A", name = "Susceptibility") +
new_scale_fill()
meta.year <- data.frame(Year = meta$Year)
rownames(meta.year) <- meta$Strain
p2 <- gheatmap(p1, meta.year, offset = 2.6, width = 0.24, colnames = FALSE) +
scale_fill_viridis(option = "D", name = "Year")
final_plot <- p2 +
geom_tiplab2(aes(label = Country), offset = 0.60, size = 2.5, color = "gray40")
final_plot
ggsave("salmonella_circular_tree.png", final_plot, width = 10, height = 10, dpi = 300)
library(ape)
library(ggplot2)
library(ggtree)
library(ggtreeExtra)
library(phangorn)
library(treeio)
library(viridis)
sal.tree = read.tree('test_salmonella_with_ERRiiiiiiiiiiiii_outgroup3.nex.treefile')
sal.meta = read.table('metadata.csv', sep=',', header=T)
sal.tree = midpoint(sal.tree)
sal.tree = read.iqtree ('test_salmonella_with_ERRiiiiiiiiiiiii_outgroup3.nex.treefile')
sal.tree@phylo = midpoint(sal.tree@phylo)
plot(sal.tree@phylo)
t1 = ggtree(sal.tree) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
t1 = ggtree(sal.tree, layout="circular") %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1')) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
library(ggnewscale)
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1')) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
meta.Susceptiblity <- as.data.frame(sal.meta[,'Susceptiblity'])
colnames(meta.Susceptiblity) <- 'Susceptiblity'
rownames(meta.Susceptiblity) <- sal.meta$Strain
meta.year <- as.data.frame(sal.meta[,'Year'])
colnames(meta.year) <- 'Year'
rownames(meta.year) <- sal.meta$Strain
t2 <- gheatmap(t1, meta.Susceptiblity, width = 9, offset = 0.51) +
scale_fill_viridis_d(option="A", name="Susceptiblity") +
new_scale_fill()
# Continuous variable
t2 <- gheatmap(t2, meta.year, width= 7, offset=0.81) +
scale_fill_viridis(option="D", name="Year")
# 8.Plot tiplab2
t2 + geom_tiplab2(aes(label=Country), color="gray40", offset=0.06, size=3)
t1 = ggtree(sal.tree) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
# 4.Circular phylogenetic tree
t1 = ggtree(sal.tree, layout="circular") %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
t1 = ggtree(sal.tree, layout="circular", size =0.8) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1')) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
# 6.Showing metadata in heatmap
# dataframe generation
meta.Susceptiblity <- as.data.frame(sal.meta[,'Susceptiblity'])
colnames(meta.Susceptiblity) <- 'Susceptiblity'
rownames(meta.Susceptiblity) <- sal.meta$Strain
meta.year <- as.data.frame(sal.meta[,'Year'])
colnames(meta.year) <- 'Year'
rownames(meta.year) <- sal.meta$Strain
# 7.Heatmap generation
# Categorical variable
t2 <- gheatmap(t1, meta.Susceptiblity, width = 9, offset = 0.51) +
scale_fill_viridis_d(option="A", name="Susceptiblity") +
new_scale_fill()
# Continuous variable
t2 <- gheatmap(t2, meta.year, width= 7, offset=0.81) +
scale_fill_viridis(option="D", name="Year")
# 8.Plot tiplab2
t2 + geom_tiplab2(aes(label=Country), color="gray40", offset=0.06, size=3)
t1 = ggtree(sal.tree) %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
# 4.Circular phylogenetic tree
t1 = ggtree(sal.tree, layout="circular") %<+% sal.meta +
geom_tippoint(aes(color = Source), size = 2)
t1
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1'), size = 0.9) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1'), size = 0.9) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1')) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1'), size =0.9) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
# 5.Add bootstrap support
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1'), size =1.2) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
t1$data$bootstrap <- '0'
t1$data[which(t1$data$SH_aLRT >= 70 & t1$data$UFboot  >= 70),]$bootstrap <- '1'
t1 <- t1 + new_scale_color() +
geom_tree(aes(color=bootstrap == '1')) +
scale_color_manual(name='Bootstrap', values=setNames( c('black', 'grey'), c(T,F)), guide = "none")
t1
